<%- include("partials/header", { title: "Products", subtitle: "Manage product categories", active: "settings" }) %>

<% if (q && q.toast) { %>
  <div class="card" style="border-color: rgba(94,234,212,.35); background: rgba(94,234,212,.10);">
    ✅ <%= q.toast %>
  </div>
<% } %>

<div class="card">
  <h2>Add Product</h2>
  <form method="POST" action="/admin/products">
    <label>Product Name</label>
    <input name="name" placeholder="e.g. Mushrooms" />
    <div style="height:10px"></div>
    <button class="btn secondary" type="submit">➕ Add</button>
  </form>
</div>

<div class="card">
  <h2>All Products</h2>
  <div class="list">
    <% (products || []).forEach(p => { %>
      <div class="order" style="cursor:default;">
        <div style="display:grid; gap:6px; width:100%;">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <div>
              <strong><%= p.name %></strong>
              <small style="display:block;">ID: <%= p.id %></small>
            </div>
            <span class="chip <%= p.is_active ? 'ok' : 'bad' %>"><%= p.is_active ? 'ACTIVE' : 'INACTIVE' %></span>
          </div>

          <form method="POST" action="/admin/products/<%= p.id %>/toggle" style="margin:0;">
            <button class="btn <%= p.is_active ? 'danger' : 'secondary' %>" type="submit">
              <%= p.is_active ? 'Disable' : 'Enable' %>
            </button>
          </form>
        </div>
      </div>
    <% }) %>
  </div>
</div>

<%- include("partials/footer", { active: "settings" }) %>
